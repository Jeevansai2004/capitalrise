{"ast":null,"code":"import React,{createContext,useContext,useState,useEffect}from'react';import{jsx as _jsx}from\"react/jsx-runtime\";const AuthContext=/*#__PURE__*/createContext({user:null,token:null,login:()=>{},logout:()=>{},loading:true});export const useAuth=()=>{const context=useContext(AuthContext);if(context===undefined){throw new Error('useAuth must be used within an AuthProvider');}return context;};export const AuthProvider=_ref=>{let{children}=_ref;const[user,setUser]=useState(null);const[token,setToken]=useState(localStorage.getItem('token'));const[loading,setLoading]=useState(true);useEffect(()=>{if(token){fetch('/api/auth/me',{headers:{'Authorization':`Bearer ${token}`,'Content-Type':'application/json'}}).then(res=>res.json()).then(data=>{if(data&&data.data&&data.data.user){setUser(data.data.user);}else{throw new Error('Invalid response structure');}}).catch(()=>{setUser(null);setToken(null);localStorage.removeItem('token');}).finally(()=>setLoading(false));}else{setLoading(false);}},[token]);const login=(token,user)=>{setToken(token);setUser(user);localStorage.setItem('token',token);};const logout=()=>{setToken(null);setUser(null);localStorage.removeItem('token');};return/*#__PURE__*/_jsx(AuthContext.Provider,{value:{user,token,login,logout,loading},children:children});};","map":{"version":3,"names":["React","createContext","useContext","useState","useEffect","jsx","_jsx","AuthContext","user","token","login","logout","loading","useAuth","context","undefined","Error","AuthProvider","_ref","children","setUser","setToken","localStorage","getItem","setLoading","fetch","headers","then","res","json","data","catch","removeItem","finally","setItem","Provider","value"],"sources":["C:/Users/saije/Downloads/capital rise/client/src/context/AuthContext.js"],"sourcesContent":["import React, { createContext, useContext, useState, useEffect } from 'react';\r\n\r\nconst AuthContext = createContext({\r\n  user: null,\r\n  token: null,\r\n  login: () => {},\r\n  logout: () => {},\r\n  loading: true\r\n});\r\n\r\nexport const useAuth = () => {\r\n  const context = useContext(AuthContext);\r\n  if (context === undefined) {\r\n    throw new Error('useAuth must be used within an AuthProvider');\r\n  }\r\n  return context;\r\n};\r\n\r\nexport const AuthProvider = ({ children }) => {\r\n  const [user, setUser] = useState(null);\r\n  const [token, setToken] = useState(localStorage.getItem('token'));\r\n  const [loading, setLoading] = useState(true);\r\n\r\n  useEffect(() => {\r\n    if (token) {\r\n      fetch('/api/auth/me', {\r\n        headers: {\r\n          'Authorization': `Bearer ${token}`,\r\n          'Content-Type': 'application/json'\r\n        }\r\n      })\r\n        .then(res => res.json())\r\n        .then(data => {\r\n          if (data && data.data && data.data.user) {\r\n            setUser(data.data.user);\r\n          } else {\r\n            throw new Error('Invalid response structure');\r\n          }\r\n        })\r\n        .catch(() => {\r\n          setUser(null);\r\n          setToken(null);\r\n          localStorage.removeItem('token');\r\n        })\r\n        .finally(() => setLoading(false));\r\n    } else {\r\n      setLoading(false);\r\n    }\r\n  }, [token]);\r\n\r\n  const login = (token, user) => {\r\n    setToken(token);\r\n    setUser(user);\r\n    localStorage.setItem('token', token);\r\n  };\r\n\r\n  const logout = () => {\r\n    setToken(null);\r\n    setUser(null);\r\n    localStorage.removeItem('token');\r\n  };\r\n\r\n  return (\r\n    <AuthContext.Provider value={{ user, token, login, logout, loading }}>\r\n      {children}\r\n    </AuthContext.Provider>\r\n  );\r\n}; "],"mappings":"AAAA,MAAO,CAAAA,KAAK,EAAIC,aAAa,CAAEC,UAAU,CAAEC,QAAQ,CAAEC,SAAS,KAAQ,OAAO,CAAC,OAAAC,GAAA,IAAAC,IAAA,yBAE9E,KAAM,CAAAC,WAAW,cAAGN,aAAa,CAAC,CAChCO,IAAI,CAAE,IAAI,CACVC,KAAK,CAAE,IAAI,CACXC,KAAK,CAAEA,CAAA,GAAM,CAAC,CAAC,CACfC,MAAM,CAAEA,CAAA,GAAM,CAAC,CAAC,CAChBC,OAAO,CAAE,IACX,CAAC,CAAC,CAEF,MAAO,MAAM,CAAAC,OAAO,CAAGA,CAAA,GAAM,CAC3B,KAAM,CAAAC,OAAO,CAAGZ,UAAU,CAACK,WAAW,CAAC,CACvC,GAAIO,OAAO,GAAKC,SAAS,CAAE,CACzB,KAAM,IAAI,CAAAC,KAAK,CAAC,6CAA6C,CAAC,CAChE,CACA,MAAO,CAAAF,OAAO,CAChB,CAAC,CAED,MAAO,MAAM,CAAAG,YAAY,CAAGC,IAAA,EAAkB,IAAjB,CAAEC,QAAS,CAAC,CAAAD,IAAA,CACvC,KAAM,CAACV,IAAI,CAAEY,OAAO,CAAC,CAAGjB,QAAQ,CAAC,IAAI,CAAC,CACtC,KAAM,CAACM,KAAK,CAAEY,QAAQ,CAAC,CAAGlB,QAAQ,CAACmB,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC,CAAC,CACjE,KAAM,CAACX,OAAO,CAAEY,UAAU,CAAC,CAAGrB,QAAQ,CAAC,IAAI,CAAC,CAE5CC,SAAS,CAAC,IAAM,CACd,GAAIK,KAAK,CAAE,CACTgB,KAAK,CAAC,cAAc,CAAE,CACpBC,OAAO,CAAE,CACP,eAAe,CAAE,UAAUjB,KAAK,EAAE,CAClC,cAAc,CAAE,kBAClB,CACF,CAAC,CAAC,CACCkB,IAAI,CAACC,GAAG,EAAIA,GAAG,CAACC,IAAI,CAAC,CAAC,CAAC,CACvBF,IAAI,CAACG,IAAI,EAAI,CACZ,GAAIA,IAAI,EAAIA,IAAI,CAACA,IAAI,EAAIA,IAAI,CAACA,IAAI,CAACtB,IAAI,CAAE,CACvCY,OAAO,CAACU,IAAI,CAACA,IAAI,CAACtB,IAAI,CAAC,CACzB,CAAC,IAAM,CACL,KAAM,IAAI,CAAAQ,KAAK,CAAC,4BAA4B,CAAC,CAC/C,CACF,CAAC,CAAC,CACDe,KAAK,CAAC,IAAM,CACXX,OAAO,CAAC,IAAI,CAAC,CACbC,QAAQ,CAAC,IAAI,CAAC,CACdC,YAAY,CAACU,UAAU,CAAC,OAAO,CAAC,CAClC,CAAC,CAAC,CACDC,OAAO,CAAC,IAAMT,UAAU,CAAC,KAAK,CAAC,CAAC,CACrC,CAAC,IAAM,CACLA,UAAU,CAAC,KAAK,CAAC,CACnB,CACF,CAAC,CAAE,CAACf,KAAK,CAAC,CAAC,CAEX,KAAM,CAAAC,KAAK,CAAGA,CAACD,KAAK,CAAED,IAAI,GAAK,CAC7Ba,QAAQ,CAACZ,KAAK,CAAC,CACfW,OAAO,CAACZ,IAAI,CAAC,CACbc,YAAY,CAACY,OAAO,CAAC,OAAO,CAAEzB,KAAK,CAAC,CACtC,CAAC,CAED,KAAM,CAAAE,MAAM,CAAGA,CAAA,GAAM,CACnBU,QAAQ,CAAC,IAAI,CAAC,CACdD,OAAO,CAAC,IAAI,CAAC,CACbE,YAAY,CAACU,UAAU,CAAC,OAAO,CAAC,CAClC,CAAC,CAED,mBACE1B,IAAA,CAACC,WAAW,CAAC4B,QAAQ,EAACC,KAAK,CAAE,CAAE5B,IAAI,CAAEC,KAAK,CAAEC,KAAK,CAAEC,MAAM,CAAEC,OAAQ,CAAE,CAAAO,QAAA,CAClEA,QAAQ,CACW,CAAC,CAE3B,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}