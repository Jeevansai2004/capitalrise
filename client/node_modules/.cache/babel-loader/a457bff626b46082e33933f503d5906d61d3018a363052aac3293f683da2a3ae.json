{"ast":null,"code":"import React,{useEffect,useState}from'react';import{useParams}from'react-router-dom';import Input from'../components/Input';import Button from'../components/Button';import toast from'react-hot-toast';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export default function ReferralLanding(){const{code}=useParams();const[details,setDetails]=useState(null);const[upi,setUpi]=useState('');const[error,setError]=useState('');const[loading,setLoading]=useState(false);const[submitted,setSubmitted]=useState(false);const[stats,setStats]=useState(null);useEffect(()=>{fetchDetails();fetchStats();// eslint-disable-next-line\n},[code]);const fetchDetails=async()=>{const res=await fetch(`/api/referral/${code}`);const data=await res.json();if(data.success)setDetails(data.data);else setError(data.message);};const fetchStats=async()=>{const res=await fetch(`/api/referral/stats/${code}`);const data=await res.json();if(data.success)setStats(data.data);};const handleSubmit=async e=>{e.preventDefault();setError('');if(!upi.trim()){setError('UPI ID is required');return;}setLoading(true);try{const res=await fetch('/api/referral/submit',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({referral_code:code,upi_id:upi})});const data=await res.json();if(!data.success)throw new Error(data.message);setSubmitted(true);toast.success('UPI submitted! Redirecting...');setTimeout(()=>{window.location.href=data.data.redirect_url;},2000);}catch(err){setError(err.message||'Submission failed');}finally{setLoading(false);}};if(error)return/*#__PURE__*/_jsx(\"div\",{className:\"flex flex-col items-center justify-center min-h-screen text-danger-600\",children:error});if(!details)return/*#__PURE__*/_jsx(\"div\",{className:\"flex flex-col items-center justify-center min-h-screen\",children:\"Loading...\"});return/*#__PURE__*/_jsx(\"div\",{className:\"min-h-screen flex flex-col items-center justify-center bg-gray-50 px-2\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"card w-full max-w-md p-8\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-2xl font-bold mb-2 text-center\",children:details.loot_title}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-gray-600 text-center mb-4\",children:[\"by \",details.client_name]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-6 text-center text-primary-700 font-semibold\",children:[\"Earn up to \\u20B9\",details.max_amount,\"!\"]}),!submitted?/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,className:\"space-y-4\",children:[/*#__PURE__*/_jsx(Input,{label:\"Your UPI ID\",value:upi,onChange:e=>setUpi(e.target.value),error:error,autoFocus:true}),/*#__PURE__*/_jsx(Button,{type:\"submit\",loading:loading,className:\"w-full\",children:\"Submit & Continue\"})]}):/*#__PURE__*/_jsx(\"div\",{className:\"text-success-700 text-center font-semibold\",children:\"Thank you! Redirecting...\"}),stats&&/*#__PURE__*/_jsxs(\"div\",{className:\"mt-8 text-xs text-gray-500 text-center\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[\"Total Referrals: \",stats.total_referrals]}),/*#__PURE__*/_jsxs(\"div\",{children:[\"Total Amount: \\u20B9\",stats.total_amount]})]})]})});}","map":{"version":3,"names":["React","useEffect","useState","useParams","Input","Button","toast","jsx","_jsx","jsxs","_jsxs","ReferralLanding","code","details","setDetails","upi","setUpi","error","setError","loading","setLoading","submitted","setSubmitted","stats","setStats","fetchDetails","fetchStats","res","fetch","data","json","success","message","handleSubmit","e","preventDefault","trim","method","headers","body","JSON","stringify","referral_code","upi_id","Error","setTimeout","window","location","href","redirect_url","err","className","children","loot_title","client_name","max_amount","onSubmit","label","value","onChange","target","autoFocus","type","total_referrals","total_amount"],"sources":["C:/Users/saije/Downloads/capital rise/client/src/pages/ReferralLanding.js"],"sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport { useParams } from 'react-router-dom';\r\nimport Input from '../components/Input';\r\nimport Button from '../components/Button';\r\nimport toast from 'react-hot-toast';\r\n\r\nexport default function ReferralLanding() {\r\n  const { code } = useParams();\r\n  const [details, setDetails] = useState(null);\r\n  const [upi, setUpi] = useState('');\r\n  const [error, setError] = useState('');\r\n  const [loading, setLoading] = useState(false);\r\n  const [submitted, setSubmitted] = useState(false);\r\n  const [stats, setStats] = useState(null);\r\n\r\n  useEffect(() => {\r\n    fetchDetails();\r\n    fetchStats();\r\n    // eslint-disable-next-line\r\n  }, [code]);\r\n\r\n  const fetchDetails = async () => {\r\n    const res = await fetch(`/api/referral/${code}`);\r\n    const data = await res.json();\r\n    if (data.success) setDetails(data.data);\r\n    else setError(data.message);\r\n  };\r\n  const fetchStats = async () => {\r\n    const res = await fetch(`/api/referral/stats/${code}`);\r\n    const data = await res.json();\r\n    if (data.success) setStats(data.data);\r\n  };\r\n\r\n  const handleSubmit = async e => {\r\n    e.preventDefault();\r\n    setError('');\r\n    if (!upi.trim()) {\r\n      setError('UPI ID is required');\r\n      return;\r\n    }\r\n    setLoading(true);\r\n    try {\r\n      const res = await fetch('/api/referral/submit', {\r\n        method: 'POST',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify({ referral_code: code, upi_id: upi }),\r\n      });\r\n      const data = await res.json();\r\n      if (!data.success) throw new Error(data.message);\r\n      setSubmitted(true);\r\n      toast.success('UPI submitted! Redirecting...');\r\n      setTimeout(() => {\r\n        window.location.href = data.data.redirect_url;\r\n      }, 2000);\r\n    } catch (err) {\r\n      setError(err.message || 'Submission failed');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  if (error) return <div className=\"flex flex-col items-center justify-center min-h-screen text-danger-600\">{error}</div>;\r\n  if (!details) return <div className=\"flex flex-col items-center justify-center min-h-screen\">Loading...</div>;\r\n\r\n  return (\r\n    <div className=\"min-h-screen flex flex-col items-center justify-center bg-gray-50 px-2\">\r\n      <div className=\"card w-full max-w-md p-8\">\r\n        <h1 className=\"text-2xl font-bold mb-2 text-center\">{details.loot_title}</h1>\r\n        <div className=\"text-gray-600 text-center mb-4\">by {details.client_name}</div>\r\n        <div className=\"mb-6 text-center text-primary-700 font-semibold\">Earn up to ₹{details.max_amount}!</div>\r\n        {!submitted ? (\r\n          <form onSubmit={handleSubmit} className=\"space-y-4\">\r\n            <Input\r\n              label=\"Your UPI ID\"\r\n              value={upi}\r\n              onChange={e => setUpi(e.target.value)}\r\n              error={error}\r\n              autoFocus\r\n            />\r\n            <Button type=\"submit\" loading={loading} className=\"w-full\">Submit &amp; Continue</Button>\r\n          </form>\r\n        ) : (\r\n          <div className=\"text-success-700 text-center font-semibold\">Thank you! Redirecting...</div>\r\n        )}\r\n        {stats && (\r\n          <div className=\"mt-8 text-xs text-gray-500 text-center\">\r\n            <div>Total Referrals: {stats.total_referrals}</div>\r\n            <div>Total Amount: ₹{stats.total_amount}</div>\r\n          </div>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n} "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}